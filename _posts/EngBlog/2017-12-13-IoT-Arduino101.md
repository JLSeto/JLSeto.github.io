---
layout: post
category: EngBlog
title: "IoT with Arduino101"
language: English
ref: Post-IoT-Arduino101
date: 2017-12-13
---

## Overview:
The [Arduino101](https://store.arduino.cc/usa/arduino-101) is a microcontroller board that is based off of the Intel Curie Module, which also includes the Intel Quark Microcontroller C1000.  This board comes with a 6-axis accelerometer/gyrometer and also has built in Bluetooth low Energy (BLE).  For this project, the Arduino101 is set up to collect acceleration and gyrometer data, and then advertise the data over BLE.  A client device is setup to connect to the Arduino101 via bluetooth, read the advertised data, and then send that data over wifi to a server. The server stores the received data in a database and then forwards it to a webpage where the data is graphed and displayed.  From the webpage, a user can choose to change the sampling frequency, and send this command all the way back to the Arduino101.  The below diagram illustrates a general overview of this project.

<div class="mb-3">
<figure>
  <img class="mx-auto d-block mb-3" style="width: 800px;" src="/assets/img/projects/arduino101/arduino101_diagram_db.png" alt="a101_diagram">
  <figcaption class="figure-caption text-center">Flow Diagram of Overall Project</figcaption>
</figure>
</div>

## How it Works:
Standard Arduino code along with the "CurieBLE" and "CurieIMU" libraries were used to write the code for the Arduino101 board.  The board is set up as a peripheral with one service that contains seven characteristics.  One characteristic is the sampling frequency (ts) which can be written to. The other six are the acceleration/gyrometer values (ax, ay, az, gx, gy, gz).  These service and characteristics are each assigned a UUID which is used by the client device to connect, subscribe, write, or receive notifications for a particular characteristic.  

On my client device, Node.js along with [Noble](https://github.com/sandeepmistry/noble) is used to search and connect to the Arduino101 over BLE.  Once connected, the client device looks under the assigned Service UUID for each Characteristic UUID.  Notifications are then turned on for each characteristic, and [Socket.io](https://socket.io/) is used to forward the sampling frequency and accelerometer/gyrometer data to my server.  (Note: One interesting point to note is the use of Socket.io over [WebSockets](https://github.com/websockets/ws).  This is because of [multiplexing](https://en.wikipedia.org/wiki/Multiplexing).  Socket.io's API makes it quite easy to send multiple signals over one channel.)

Node.js along with [Express](https://expressjs.com/) is used to set up my server and [MongoDB](https://www.mongodb.com/) was used as my database.  Socket.io once again forwards the data from my server to my webpage, where the raw data values are displayed and graphed for the user.  From the webpage, the user can also choose to change the sampling frequency of the Arduino101.  These effects take place nearly instantaneously thanks Socket.io and Noble. The user can also see this change when the data incoming data speeds or slows down based on the new sampling frequency they choose.  The webpage was created using frameworks such as [Bootstrap](https://getbootstrap.com/) and [Angularjs](https://angularjs.org/). Google Charts is used to graph the acceleration values in real time.  This project is available on [github](https://github.com/JLSeto/Arduino101) and a demo is available on [youtube](https://www.youtube.com/watch?v=2XyzMGU4GSo).

## Hardware:
- Arduino101
- Laptop (Ubuntu OS)
- Optional: Intel Edison or Raspberry Pie (set up as a client device)

## Software/Modules/Frameworks:
- Node.js
- Socket.io
- Noble
- Express
- Angularjs
- BootStrap
- Google Charts
- HTML, CSS, JavaScript

## References:
[CurieBLE](https://www.arduino.cc/en/Reference/CurieBLE)<br>
[Multiplexing using Websockets](https://www.rabbitmq.com/blog/2012/02/23/how-to-compose-apps-using-websockets/)<br>
